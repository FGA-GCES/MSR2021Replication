Promise fired before waiting for result
